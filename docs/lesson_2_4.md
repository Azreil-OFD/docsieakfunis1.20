# Добавление записей в таблицу через Sequelize

Модель в Sequelize представляет таблицу в БД и содержит описание ее полей, типов данных, валидации и отношений с другими таблицами. 

Синхронизация нужна, чтобы на основе моделей автоматически создать соответствующие таблицы в БД. Это позволяет быстро инициализировать структуру БД.

Синхронизация выполняется с помощью метода `sync()` на экземпляре Sequelize. При первом запуске для несуществующей БД будут автоматически созданы все необходимые таблицы.

## Создание таблицы по модели User с Sequelize

Для синхронизации моделей и БД:

1. Нужно импортируем инициатор модели:

```js
// Импортируем модели
const UserInitiator = require('./models/User');
```

2. Внедряем модель User в sequelize, а так же получаем объект для взаимодействия с базой:

```js
const User = UserInitiator(sequelize) 
```

3. Вызвать метод `sync()`:

```js
sequelize.sync()
  .then(() => {
    console.log('БД и таблицы созданы'); 
  });
```

3. После синхронизации модели готовы к использованию для выполнения запросов и работы с данными.

## Создание нового пользователя

```js
// Создаем объект нового пользователя
const newUser = {
  firstName: 'John',
  lastName: 'Doe',
  email: 'john@example.com'
};

// Добавляем пользователя в БД
User.create(newUser)
  .then(user => {
    console.log('Пользователь создан:', user.id);
  })
  .catch(err => {
    console.log('Ошибка создания пользователя:', err); 
  });
```

Чтобы добавить новую запись в таблицу с помощью Sequelize, нужно:

1. Импортировать модель таблицы (здесь - User)
2. Создать объект данных для новой записи  
3. Вызвать метод `create()` на модели, передав объект данных
4. В обработчике `.then()` получить созданную запись
5. В обработчике `.catch()` отловить возможные ошибки

Sequelize автоматически сгенерирует SQL-запрос для вставки данных в соответствующую таблицу БД.

## Удаление записей и таблиц

### Удаление записи

Чтобы удалить запись из таблицы, нужно вызвать метод `destroy()` на экземпляре модели:

```js
User.findByPk(1)
  .then(user => {
    user.destroy(); 
  })
  .catch(err => {
    console.log('Ошибка удаления пользователя:', err);
  });
```

Sequelize автоматически сгенерирует SQL-запрос для удаления записи по первичному ключу.


### Удаление таблицы 

Чтобы удалить таблицу целиком, используйте метод `drop()` на модели:

```js
await User.drop();
console.log('Таблица `User` была удалена.');
```

### Удаление всех таблиц из базы данных

Чтобы полностью очистить базу данных, вызовите метод `drop()` на экземпляре Sequelize:

```js
await sequelize.drop(); 
console.log('Все таблицы были удалены.');
```

Это удалит все таблицы, созданные через модели Sequelize в данной базе данных.

- [Прошлая статья](lesson_2_3.md)
- [Следующая статья](lesson_2_5.md)